
Threestudio.ipynb_
Notebook unstarred
Files
..
Drop files to upload them to session storage.
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

#@title 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
from huggingface_hub import interpreter_login

interpreter_login()


    _|    _|  _|    _|    _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|_|_|_|    _|_|      _|_|_|  _|_|_|_|
    _|    _|  _|    _|  _|        _|          _|    _|_|    _|  _|            _|        _|    _|  _|        _|
    _|_|_|_|  _|    _|  _|  _|_|  _|  _|_|    _|    _|  _|  _|  _|  _|_|      _|_|_|    _|_|_|_|  _|        _|_|_|
    _|    _|  _|    _|  _|    _|  _|    _|    _|    _|    _|_|  _|    _|      _|        _|    _|  _|        _|
    _|    _|    _|_|      _|_|_|    _|_|_|  _|_|_|  _|      _|    _|_|_|      _|        _|    _|    _|_|_|  _|_|_|_|

    To login, `huggingface_hub` requires a token generated from https://huggingface.co/settings/tokens .
Token: ··········
Add token as git credential? (Y/n) Y
Token is valid (permission: write).
Your token has been saved in your configured git credential helpers (store).
Your token has been saved to /root/.cache/huggingface/token
Login successful

from google.colab import drive
drive.mount('/content/drive')

Mounted at /content/drive

Clone threestudio repo

import os

!git clone https://github.com/git2andi/Evaluate3D.git
!git clone https://github.com/threestudio-project/threestudio.git
%cd threestudio


!pip install ninja
!pip install lightning==2.0.0 omegaconf==2.3.0 jaxtyping typeguard diffusers transformers accelerate opencv-python tensorboard matplotlib imageio imageio[ffmpeg] trimesh bitsandbytes sentencepiece safetensors huggingface_hub libigl xatlas networkx pysdf PyMCubes wandb torchmetrics controlnet_aux
!pip install einops kornia taming-transformers-rom1504 git+https://github.com/openai/CLIP.git # zero123
!pip install open3d
!pip install mediapipe
!pip install "diffusers<0.20"
!pip install trimesh
!pip install pygltflib

!pip install git+https://github.com/ashawkey/envlight.git
!pip install git+https://github.com/KAIR-BAIR/nerfacc.git@v0.5.2  # ~5min
!pip install git+https://github.com/NVlabs/nvdiffrast.git
!pip install git+https://github.com/NVlabs/tiny-cuda-nn/#subdirectory=bindings/torch  # ~20-30min

prompt = "a zoomed out DSLR of a robot made out of plants"

All Models
Dreamfusion-if

# Train
!python launch.py --config configs/dreamfusion-if.yaml --train --gpu 0 system.prompt_processor.prompt="$prompt"

# Export Mesh (maybe change system.geometry_convert_override.isosurface_threshold=X; increase X if result is extruded, decrease if incomplete; auto = 25)
!python launch.py --config /content/threestudio/outputs/dreamfusion-if/a_zoomed_out_DSLR_of_a_robot_made_out_of_plants@20231203-150835/configs/parsed.yaml --export --gpu 0 resume=/content/threestudio/outputs/dreamfusion-if/a_zoomed_out_DSLR_of_a_robot_made_out_of_plants@20231203-150835/ckpts/last.ckpt system.exporter_type=mesh-exporter system.geometry.isosurface_threshold=auto

# Export Mesh (should be better but is it?)
!python launch.py --config /content/threestudio/outputs/dreamfusion-if/an_equipped_Playmobil_firefighter_holding_a_hose_in_his_hands@20231111-151230/configs/parsed.yaml --export --gpu 0 resume=/content/threestudio/outputs/dreamfusion-if/an_equipped_Playmobil_firefighter_holding_a_hose_in_his_hands@20231111-151230/ckpts/last.ckpt system.exporter_type=mesh-exporter system.geometry.isosurface_method=mc-cpu system.geometry.isosurface_resolution=256

!cp -r /content/threestudio/outputs/dreamfusion-if/ /content/drive/MyDrive/threestudio/

Magic3D

# Train Base
!python launch.py --config configs/magic3d-coarse-if.yaml --train --gpu 0 system.prompt_processor.prompt="$prompt"

2023-12-03 16:48:28.704868: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-12-03 16:48:28.704928: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-12-03 16:48:28.704957: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-12-03 16:48:30.039404: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Using 16bit Automatic Mixed Precision (AMP)
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] 
  | Name       | Type                           | Params
--------------------------------------------------------------
0 | geometry   | ImplicitVolume                 | 12.6 M
1 | material   | DiffuseWithPointLightMaterial  | 0     
2 | background | NeuralEnvironmentMapBackground | 448   
3 | renderer   | NeRFVolumeRenderer             | 0     
--------------------------------------------------------------
12.6 M    Trainable params
0         Non-trainable params
12.6 M    Total params
50.419    Total estimated model params size (MB)
[INFO] Validation results will be saved to outputs/magic3d-coarse-if/a_zoomed_out_DSLR_of_a_robot_made_out_of_plants@20231203-164832/save
[INFO] Using prompt [a zoomed out DSLR of a robot made out of plants] and negative prompt []
[INFO] Using view-dependent prompts [side]:[a zoomed out DSLR of a robot made out of plants, side view] [front]:[a zoomed out DSLR of a robot made out of plants, front view] [back]:[a zoomed out DSLR of a robot made out of plants, back view] [overhead]:[a zoomed out DSLR of a robot made out of plants, overhead view]
[INFO] Loading Deep Floyd ...

A mixture of fp16 and non-fp16 filenames will be loaded.
Loaded fp16 filenames:
[text_encoder/model.fp16-00001-of-00002.safetensors, unet/diffusion_pytorch_model.fp16.safetensors, text_encoder/model.fp16-00002-of-00002.safetensors, safety_checker/model.fp16.safetensors]
Loaded non-fp16 filenames:
[watermarker/diffusion_pytorch_model.safetensors
If this behavior is not expected, please check your folder structure.
Loading pipeline components...:  67% 2/3 [00:00<00:00, 11.94it/s]You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading pipeline components...: 100% 3/3 [00:00<00:00,  9.33it/s]
[INFO] Loaded Deep Floyd!
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Epoch 0: |          | 0/? [00:00<?, ?it/s] /usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step': ...})` instead.
Epoch 0: |          | 200/? [01:34<00:00,  2.13it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  2.82it/s]
Epoch 0: |          | 400/? [03:14<00:00,  2.06it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  3.22it/s]
Epoch 0: |          | 600/? [04:55<00:00,  2.03it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  3.21it/s]
Epoch 0: |          | 800/? [06:39<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  3.36it/s]
Epoch 0: |          | 1000/? [08:21<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  3.54it/s]
Epoch 0: |          | 1200/? [10:03<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  3.70it/s]
Epoch 0: |          | 1400/? [11:45<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.05it/s]
Epoch 0: |          | 1600/? [13:26<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.14it/s]
Epoch 0: |          | 1800/? [15:08<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.44it/s]
Epoch 0: |          | 2000/? [16:49<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.54it/s]
Epoch 0: |          | 2200/? [18:29<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.77it/s]
Epoch 0: |          | 2400/? [20:10<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.86it/s]
Epoch 0: |          | 2600/? [21:51<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.98it/s]
Epoch 0: |          | 2800/? [23:32<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.90it/s]
Epoch 0: |          | 3000/? [25:12<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.96it/s]
Epoch 0: |          | 3200/? [26:52<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  4.98it/s]
Epoch 0: |          | 3400/? [28:33<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.13it/s]
Epoch 0: |          | 3600/? [30:13<00:00,  1.98it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.29it/s]
Epoch 0: |          | 3800/? [31:54<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.11it/s]
Epoch 0: |          | 4000/? [33:35<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.26it/s]
Epoch 0: |          | 4200/? [35:15<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.42it/s]
Epoch 0: |          | 4400/? [36:55<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.49it/s]
Epoch 0: |          | 4600/? [38:36<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.79it/s]
Epoch 0: |          | 4800/? [40:16<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.81it/s]
Epoch 0: |          | 5000/? [41:55<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.82it/s]
Epoch 0: |          | 5200/? [43:35<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  5.97it/s]
Epoch 0: |          | 5400/? [45:15<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.14it/s]
Epoch 0: |          | 5600/? [46:54<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.02it/s]
Epoch 0: |          | 5800/? [48:34<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.25it/s]
Epoch 0: |          | 6000/? [50:14<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.01it/s]
Epoch 0: |          | 6200/? [51:53<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.21it/s]
Epoch 0: |          | 6400/? [53:32<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.31it/s]
Epoch 0: |          | 6600/? [55:12<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.23it/s]
Epoch 0: |          | 6800/? [56:51<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.39it/s]
Epoch 0: |          | 7000/? [58:30<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.31it/s]
Epoch 0: |          | 7200/? [1:00:10<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.40it/s]
Epoch 0: |          | 7400/? [1:01:49<00:00,  1.99it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.55it/s]
Epoch 0: |          | 7600/? [1:03:28<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.61it/s]
Epoch 0: |          | 7800/? [1:05:08<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.73it/s]
Epoch 0: |          | 8000/? [1:06:48<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.57it/s]
Epoch 0: |          | 8200/? [1:08:27<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.78it/s]
Epoch 0: |          | 8400/? [1:10:07<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.65it/s]
Epoch 0: |          | 8600/? [1:11:46<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.81it/s]
Epoch 0: |          | 8800/? [1:13:25<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.71it/s]
Epoch 0: |          | 9000/? [1:15:04<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.65it/s]
Epoch 0: |          | 9200/? [1:16:44<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.75it/s]
Epoch 0: |          | 9400/? [1:18:23<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.82it/s]
Epoch 0: |          | 9600/? [1:20:02<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.99it/s]
Epoch 0: |          | 9800/? [1:21:41<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.74it/s]
Epoch 0: |          | 10000/? [1:23:20<00:00,  2.00it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00,  6.79it/s]
Epoch 0: |          | 10000/? [1:23:21<00:00,  2.00it/s][INFO] `Trainer.fit` stopped: `max_steps=10000` reached.
Epoch 0: |          | 10000/? [1:23:21<00:00,  2.00it/s]
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100% 120/120 [00:21<00:00,  5.60it/s]
[INFO] Test results saved to outputs/magic3d-coarse-if/a_zoomed_out_DSLR_of_a_robot_made_out_of_plants@20231203-164832/save

2023-11-26 23:32:10.220435: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-26 23:32:10.220493: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-26 23:32:10.220522: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-26 23:32:11.271439: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Initializing geometry from a given checkpoint ...
[INFO] Automatically determined isosurface threshold: 21.27476692199707
[INFO] Automatically determined isosurface threshold: 35.500587463378906
[INFO] Using 16bit Automatic Mixed Precision (AMP)
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] 
  | Name       | Type                           | Params
--------------------------------------------------------------
0 | geometry   | TetrahedraSDFGrid              | 13.7 M
1 | material   | DiffuseWithPointLightMaterial  | 0     
2 | background | NeuralEnvironmentMapBackground | 448   
3 | renderer   | NVDiffRasterizer               | 0     
--------------------------------------------------------------
13.7 M    Trainable params
0         Non-trainable params
13.7 M    Total params
54.849    Total estimated model params size (MB)
[INFO] Validation results will be saved to outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/save
[INFO] Using prompt [Highly detailed and symmetrical loaf of bread] and negative prompt []
[INFO] Using view-dependent prompts [side]:[Highly detailed and symmetrical loaf of bread, side view] [front]:[Highly detailed and symmetrical loaf of bread, front view] [back]:[Highly detailed and symmetrical loaf of bread, back view] [overhead]:[Highly detailed and symmetrical loaf of bread, overhead view]
2023-11-26 23:32:24.357353: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-26 23:32:24.357413: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-26 23:32:24.357438: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-26 23:32:25.390045: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
tokenizer/tokenizer_config.json: 100% 807/807 [00:00<00:00, 4.81MB/s]
tokenizer/vocab.json: 100% 1.06M/1.06M [00:00<00:00, 42.1MB/s]
tokenizer/merges.txt: 100% 525k/525k [00:00<00:00, 32.2MB/s]
tokenizer/special_tokens_map.json: 100% 460/460 [00:00<00:00, 2.82MB/s]
text_encoder/config.json: 100% 613/613 [00:00<00:00, 3.39MB/s]
model.safetensors: 100% 1.36G/1.36G [00:02<00:00, 470MB/s]
[INFO] Loading Stable Diffusion ...
model_index.json: 100% 543/543 [00:00<00:00, 3.04MB/s]
Fetching 8 files:   0% 0/8 [00:00<?, ?it/s]
diffusion_pytorch_model.safetensors:   0% 0.00/3.46G [00:00<?, ?B/s]

diffusion_pytorch_model.safetensors:   0% 0.00/335M [00:00<?, ?B/s]


vae/config.json: 100% 553/553 [00:00<00:00, 2.78MB/s]

diffusion_pytorch_model.safetensors:   1% 31.5M/3.46G [00:00<00:11, 300MB/s]


unet/config.json: 100% 911/911 [00:00<00:00, 3.77MB/s]


diffusion_pytorch_model.safetensors:   9% 31.5M/335M [00:00<00:01, 293MB/s]


scheduler/scheduler_config.json: 100% 346/346 [00:00<00:00, 2.08MB/s]
Fetching 8 files:  25% 2/8 [00:01<00:03,  1.63it/s]
diffusion_pytorch_model.safetensors:   2% 83.9M/3.46G [00:00<00:08, 390MB/s]

diffusion_pytorch_model.safetensors:  22% 73.4M/335M [00:00<00:00, 340MB/s]
diffusion_pytorch_model.safetensors:   4% 136M/3.46G [00:00<00:08, 411MB/s] 

diffusion_pytorch_model.safetensors:  38% 126M/335M [00:00<00:00, 382MB/s] 
diffusion_pytorch_model.safetensors:   5% 189M/3.46G [00:00<00:07, 429MB/s]

diffusion_pytorch_model.safetensors:  53% 178M/335M [00:00<00:00, 411MB/s]
diffusion_pytorch_model.safetensors:   7% 241M/3.46G [00:00<00:07, 439MB/s]

diffusion_pytorch_model.safetensors:  69% 231M/335M [00:00<00:00, 428MB/s]
diffusion_pytorch_model.safetensors:   8% 294M/3.46G [00:00<00:07, 437MB/s]

diffusion_pytorch_model.safetensors:  85% 283M/335M [00:00<00:00, 429MB/s]
diffusion_pytorch_model.safetensors:  10% 346M/3.46G [00:00<00:07, 433MB/s]

diffusion_pytorch_model.safetensors: 100% 335M/335M [00:00<00:00, 405MB/s]

diffusion_pytorch_model.safetensors:  12% 398M/3.46G [00:00<00:06, 446MB/s]
diffusion_pytorch_model.safetensors:  13% 451M/3.46G [00:01<00:06, 459MB/s]
diffusion_pytorch_model.safetensors:  15% 503M/3.46G [00:01<00:06, 460MB/s]
diffusion_pytorch_model.safetensors:  16% 556M/3.46G [00:01<00:06, 456MB/s]
diffusion_pytorch_model.safetensors:  18% 608M/3.46G [00:01<00:06, 457MB/s]
diffusion_pytorch_model.safetensors:  19% 661M/3.46G [00:01<00:06, 432MB/s]
diffusion_pytorch_model.safetensors:  21% 713M/3.46G [00:01<00:06, 426MB/s]
diffusion_pytorch_model.safetensors:  22% 765M/3.46G [00:01<00:06, 438MB/s]
diffusion_pytorch_model.safetensors:  24% 818M/3.46G [00:01<00:06, 423MB/s]
diffusion_pytorch_model.safetensors:  25% 870M/3.46G [00:02<00:06, 424MB/s]
diffusion_pytorch_model.safetensors:  27% 923M/3.46G [00:02<00:05, 434MB/s]
diffusion_pytorch_model.safetensors:  28% 975M/3.46G [00:02<00:05, 432MB/s]
diffusion_pytorch_model.safetensors:  30% 1.03G/3.46G [00:02<00:05, 437MB/s]
diffusion_pytorch_model.safetensors:  31% 1.08G/3.46G [00:02<00:05, 429MB/s]
diffusion_pytorch_model.safetensors:  33% 1.13G/3.46G [00:02<00:05, 439MB/s]
diffusion_pytorch_model.safetensors:  34% 1.18G/3.46G [00:02<00:05, 436MB/s]
diffusion_pytorch_model.safetensors:  36% 1.24G/3.46G [00:02<00:05, 443MB/s]
diffusion_pytorch_model.safetensors:  37% 1.29G/3.46G [00:02<00:05, 431MB/s]
diffusion_pytorch_model.safetensors:  39% 1.34G/3.46G [00:03<00:04, 438MB/s]
diffusion_pytorch_model.safetensors:  40% 1.39G/3.46G [00:03<00:04, 446MB/s]
diffusion_pytorch_model.safetensors:  42% 1.45G/3.46G [00:03<00:04, 434MB/s]
diffusion_pytorch_model.safetensors:  43% 1.50G/3.46G [00:03<00:05, 385MB/s]
diffusion_pytorch_model.safetensors:  45% 1.54G/3.46G [00:03<00:05, 325MB/s]
diffusion_pytorch_model.safetensors:  46% 1.58G/3.46G [00:03<00:06, 296MB/s]
diffusion_pytorch_model.safetensors:  47% 1.61G/3.46G [00:03<00:06, 278MB/s]
diffusion_pytorch_model.safetensors:  48% 1.65G/3.46G [00:04<00:06, 270MB/s]
diffusion_pytorch_model.safetensors:  48% 1.68G/3.46G [00:04<00:07, 252MB/s]
diffusion_pytorch_model.safetensors:  49% 1.71G/3.46G [00:04<00:07, 247MB/s]
diffusion_pytorch_model.safetensors:  50% 1.74G/3.46G [00:04<00:07, 232MB/s]
diffusion_pytorch_model.safetensors:  51% 1.77G/3.46G [00:04<00:07, 231MB/s]
diffusion_pytorch_model.safetensors:  52% 1.80G/3.46G [00:04<00:07, 227MB/s]
diffusion_pytorch_model.safetensors:  53% 1.84G/3.46G [00:04<00:06, 234MB/s]
diffusion_pytorch_model.safetensors:  54% 1.87G/3.46G [00:05<00:06, 239MB/s]
diffusion_pytorch_model.safetensors:  55% 1.90G/3.46G [00:05<00:06, 256MB/s]
diffusion_pytorch_model.safetensors:  56% 1.94G/3.46G [00:05<00:05, 287MB/s]
diffusion_pytorch_model.safetensors:  58% 1.99G/3.46G [00:05<00:04, 339MB/s]
diffusion_pytorch_model.safetensors:  59% 2.03G/3.46G [00:05<00:04, 354MB/s]
diffusion_pytorch_model.safetensors:  60% 2.08G/3.46G [00:05<00:03, 363MB/s]
diffusion_pytorch_model.safetensors:  61% 2.12G/3.46G [00:05<00:03, 372MB/s]
diffusion_pytorch_model.safetensors:  62% 2.16G/3.46G [00:05<00:03, 364MB/s]
diffusion_pytorch_model.safetensors:  64% 2.20G/3.46G [00:05<00:03, 370MB/s]
diffusion_pytorch_model.safetensors:  65% 2.26G/3.46G [00:06<00:02, 423MB/s]
diffusion_pytorch_model.safetensors:  67% 2.33G/3.46G [00:06<00:02, 459MB/s]
diffusion_pytorch_model.safetensors:  69% 2.38G/3.46G [00:06<00:02, 454MB/s]
diffusion_pytorch_model.safetensors:  70% 2.43G/3.46G [00:06<00:02, 465MB/s]
diffusion_pytorch_model.safetensors:  72% 2.49G/3.46G [00:06<00:02, 471MB/s]
diffusion_pytorch_model.safetensors:  73% 2.54G/3.46G [00:06<00:02, 460MB/s]
diffusion_pytorch_model.safetensors:  75% 2.59G/3.46G [00:06<00:01, 472MB/s]
diffusion_pytorch_model.safetensors:  76% 2.64G/3.46G [00:06<00:01, 443MB/s]
diffusion_pytorch_model.safetensors:  78% 2.69G/3.46G [00:07<00:01, 429MB/s]
diffusion_pytorch_model.safetensors:  79% 2.75G/3.46G [00:07<00:01, 426MB/s]
diffusion_pytorch_model.safetensors:  81% 2.80G/3.46G [00:07<00:01, 431MB/s]
diffusion_pytorch_model.safetensors:  82% 2.85G/3.46G [00:07<00:01, 402MB/s]
diffusion_pytorch_model.safetensors:  84% 2.89G/3.46G [00:07<00:01, 382MB/s]
diffusion_pytorch_model.safetensors:  85% 2.94G/3.46G [00:07<00:01, 356MB/s]
diffusion_pytorch_model.safetensors:  86% 2.98G/3.46G [00:07<00:01, 338MB/s]
diffusion_pytorch_model.safetensors:  87% 3.02G/3.46G [00:07<00:01, 321MB/s]
diffusion_pytorch_model.safetensors:  88% 3.06G/3.46G [00:08<00:01, 304MB/s]
diffusion_pytorch_model.safetensors:  89% 3.09G/3.46G [00:08<00:01, 297MB/s]
diffusion_pytorch_model.safetensors:  90% 3.12G/3.46G [00:08<00:01, 285MB/s]
diffusion_pytorch_model.safetensors:  91% 3.16G/3.46G [00:08<00:01, 277MB/s]
diffusion_pytorch_model.safetensors:  92% 3.19G/3.46G [00:08<00:01, 274MB/s]
diffusion_pytorch_model.safetensors:  93% 3.22G/3.46G [00:08<00:00, 282MB/s]
diffusion_pytorch_model.safetensors:  94% 3.25G/3.46G [00:08<00:00, 284MB/s]
diffusion_pytorch_model.safetensors:  95% 3.28G/3.46G [00:08<00:00, 280MB/s]
diffusion_pytorch_model.safetensors:  96% 3.31G/3.46G [00:09<00:00, 275MB/s]
diffusion_pytorch_model.safetensors:  97% 3.34G/3.46G [00:09<00:00, 271MB/s]
diffusion_pytorch_model.safetensors:  97% 3.38G/3.46G [00:09<00:00, 274MB/s]
diffusion_pytorch_model.safetensors:  98% 3.41G/3.46G [00:09<00:00, 266MB/s]
diffusion_pytorch_model.safetensors: 100% 3.46G/3.46G [00:09<00:00, 358MB/s]
Fetching 8 files: 100% 8/8 [00:10<00:00,  1.35s/it]
Loading pipeline components...: 100% 4/4 [00:01<00:00,  2.34it/s]
[INFO] Loaded Stable Diffusion!
Sanity Checking: |          | 0/? [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Epoch 0: |          | 0/? [00:00<?, ?it/s] /usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step': ...})` instead.
Epoch 0: |          | 100/? [00:47<00:00,  2.11it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 27.11it/s]
Epoch 0: |          | 200/? [01:35<00:00,  2.09it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.35it/s]
Epoch 0: |          | 300/? [02:23<00:00,  2.09it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.95it/s]
Epoch 0: |          | 400/? [03:10<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 27.34it/s]
Epoch 0: |          | 500/? [03:58<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.90it/s]
Epoch 0: |          | 600/? [04:46<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 23.79it/s]
Epoch 0: |          | 700/? [05:33<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.52it/s]
Epoch 0: |          | 800/? [06:21<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.70it/s]
Epoch 0: |          | 900/? [07:09<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.34it/s]
Epoch 0: |          | 1000/? [07:56<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.50it/s]
Epoch 0: |          | 1100/? [08:44<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 27.36it/s]
Epoch 0: |          | 1200/? [09:31<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 23.55it/s]
Epoch 0: |          | 1300/? [10:19<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.18it/s]
Epoch 0: |          | 1400/? [11:07<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.87it/s]
Epoch 0: |          | 1500/? [11:54<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.82it/s]
Epoch 0: |          | 1600/? [12:42<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.10it/s]
Epoch 0: |          | 1700/? [13:30<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.30it/s]
Epoch 0: |          | 1800/? [14:18<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.77it/s]
Epoch 0: |          | 1900/? [15:05<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.96it/s]
Epoch 0: |          | 2000/? [15:53<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.43it/s]
Epoch 0: |          | 2100/? [16:41<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.09it/s]
Epoch 0: |          | 2200/? [17:28<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.07it/s]
Epoch 0: |          | 2300/? [18:16<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.88it/s]
Epoch 0: |          | 2400/? [19:04<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.11it/s]
Epoch 0: |          | 2500/? [19:51<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.29it/s]
Epoch 0: |          | 2600/? [20:39<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.37it/s]
Epoch 0: |          | 2700/? [21:27<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.40it/s]
Epoch 0: |          | 2800/? [22:14<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.44it/s]
Epoch 0: |          | 2900/? [23:02<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.54it/s]
Epoch 0: |          | 3000/? [23:50<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 23.62it/s]
Epoch 0: |          | 3100/? [24:37<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.53it/s]
Epoch 0: |          | 3200/? [25:25<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.69it/s]
Epoch 0: |          | 3300/? [26:13<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 22.68it/s]
Epoch 0: |          | 3400/? [27:00<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.94it/s]
Epoch 0: |          | 3500/? [27:48<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.45it/s]
Epoch 0: |          | 3600/? [28:35<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 19.52it/s]
Epoch 0: |          | 3700/? [29:23<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.39it/s]
Epoch 0: |          | 3800/? [30:11<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.10it/s]
Epoch 0: |          | 3900/? [30:58<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.41it/s]
Epoch 0: |          | 4000/? [31:46<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.11it/s]
Epoch 0: |          | 4100/? [32:34<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 26.14it/s]
Epoch 0: |          | 4200/? [33:21<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.29it/s]
Epoch 0: |          | 4300/? [34:09<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.62it/s]
Epoch 0: |          | 4400/? [34:56<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.36it/s]
Epoch 0: |          | 4500/? [35:44<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.06it/s]
Epoch 0: |          | 4600/? [36:31<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.77it/s]
Epoch 0: |          | 4700/? [37:19<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.45it/s]
Epoch 0: |          | 4800/? [38:06<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 20.71it/s]
Epoch 0: |          | 4900/? [38:54<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 25.26it/s]
Epoch 0: |          | 5000/? [39:41<00:00,  2.10it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/1 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/1 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 1/1 [00:00<00:00, 24.54it/s]
Epoch 0: |          | 5000/? [39:42<00:00,  2.10it/s][INFO] `Trainer.fit` stopped: `max_steps=5000` reached.
Epoch 0: |          | 5000/? [39:42<00:00,  2.10it/s]
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100% 120/120 [00:07<00:00, 15.26it/s]
[INFO] Test results saved to outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/save

# Export Mesh Refine
!python launch.py --config /content/threestudio/outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/configs/parsed.yaml --export --gpu 0 resume=/content/threestudio/outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/ckpts/last.ckpt system.exporter_type=mesh-exporter system.geometry_convert_override.isosurface_threshold=auto

2023-11-27 00:13:00.373550: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-27 00:13:00.373604: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-27 00:13:00.373629: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-27 00:13:01.591089: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Using 16bit Automatic Mixed Precision (AMP)
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] Restoring states from the checkpoint path at /content/threestudio/outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/ckpts/last.ckpt
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] Loaded model weights from the checkpoint at /content/threestudio/outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/ckpts/last.ckpt
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'predict_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Predicting DataLoader 0:   0% 0/120 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/pytorch_lightning/loops/prediction_loop.py:252: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100% 120/120 [00:01<00:00, 94.76it/s][INFO] Using xatlas to perform UV unwrapping, may take a while ...
[INFO] Exporting textures ...
[INFO] Perform UV padding on texture maps to avoid seams, may take a while ...
Predicting DataLoader 0: 100% 120/120 [01:22<00:00,  1.46it/s]
[INFO] Export assets saved to outputs/magic3d-refine-sd/Highly_detailed_and_symmetrical_loaf_of_bread@20231126-233213/save

Latentnerf
↳ 9 cells hidden
Fantasia3D
↳ 5 cells hidden
Magic123

# Train base
!python launch.py --config configs/magic123-coarse-sd.yaml --train --gpu 0 data.image_path=/content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png system.prompt_processor.prompt="$prompt"

2023-11-28 23:02:55.716264: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-28 23:02:55.716319: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-28 23:02:55.716348: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-28 23:02:56.760385: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Loading Stable Diffusion ...
model_index.json: 100% 541/541 [00:00<00:00, 3.22MB/s]
Fetching 8 files:   0% 0/8 [00:00<?, ?it/s]
model.safetensors:   0% 0.00/492M [00:00<?, ?B/s]

unet/config.json: 100% 743/743 [00:00<00:00, 4.43MB/s]


scheduler/scheduler_config.json: 100% 308/308 [00:00<00:00, 2.26MB/s]
Fetching 8 files:  25% 2/8 [00:01<00:04,  1.22it/s]

text_encoder/config.json: 100% 617/617 [00:00<00:00, 3.73MB/s]


diffusion_pytorch_model.safetensors:   0% 0.00/335M [00:00<?, ?B/s]


diffusion_pytorch_model.safetensors:   0% 0.00/3.44G [00:00<?, ?B/s]
model.safetensors:   4% 21.0M/492M [00:00<00:02, 185MB/s]



vae/config.json: 100% 547/547 [00:00<00:00, 2.61MB/s]


diffusion_pytorch_model.safetensors:   9% 31.5M/335M [00:00<00:01, 283MB/s]


diffusion_pytorch_model.safetensors:   1% 31.5M/3.44G [00:00<00:12, 264MB/s]
model.safetensors:  13% 62.9M/492M [00:00<00:01, 285MB/s]

diffusion_pytorch_model.safetensors:  22% 73.4M/335M [00:00<00:00, 342MB/s]


diffusion_pytorch_model.safetensors:   2% 73.4M/3.44G [00:00<00:10, 328MB/s]
model.safetensors:  21% 105M/492M [00:00<00:01, 326MB/s] 

diffusion_pytorch_model.safetensors:  34% 115M/335M [00:00<00:00, 362MB/s] 


diffusion_pytorch_model.safetensors:   3% 115M/3.44G [00:00<00:09, 344MB/s] 
model.safetensors:  30% 147M/492M [00:00<00:00, 356MB/s]

diffusion_pytorch_model.safetensors:  47% 157M/335M [00:00<00:00, 365MB/s]


diffusion_pytorch_model.safetensors:   5% 157M/3.44G [00:00<00:09, 352MB/s]
model.safetensors:  38% 189M/492M [00:00<00:00, 362MB/s]

diffusion_pytorch_model.safetensors:  60% 199M/335M [00:00<00:00, 366MB/s]


diffusion_pytorch_model.safetensors:   6% 199M/3.44G [00:00<00:09, 356MB/s]
model.safetensors:  47% 231M/492M [00:00<00:00, 363MB/s]

diffusion_pytorch_model.safetensors:  72% 241M/335M [00:00<00:00, 339MB/s]


diffusion_pytorch_model.safetensors:   7% 241M/3.44G [00:00<00:09, 331MB/s]
model.safetensors:  55% 273M/492M [00:00<00:00, 368MB/s]

diffusion_pytorch_model.safetensors:  85% 283M/335M [00:00<00:00, 330MB/s]
model.safetensors:  64% 315M/492M [00:00<00:00, 375MB/s]


diffusion_pytorch_model.safetensors:   8% 283M/3.44G [00:00<00:09, 325MB/s]

diffusion_pytorch_model.safetensors:  97% 325M/335M [00:00<00:00, 341MB/s]
model.safetensors:  72% 357M/492M [00:01<00:00, 370MB/s]


diffusion_pytorch_model.safetensors: 100% 335M/335M [00:00<00:00, 342MB/s]



diffusion_pytorch_model.safetensors:  11% 377M/3.44G [00:01<00:08, 373MB/s]
model.safetensors:  83% 409M/492M [00:01<00:00, 375MB/s]


diffusion_pytorch_model.safetensors:  12% 419M/3.44G [00:01<00:10, 296MB/s]
model.safetensors:  92% 451M/492M [00:01<00:00, 296MB/s]


diffusion_pytorch_model.safetensors:  13% 461M/3.44G [00:01<00:11, 262MB/s]
model.safetensors: 100% 492M/492M [00:01<00:00, 300MB/s]
Fetching 8 files:  50% 4/8 [00:03<00:03,  1.24it/s]


diffusion_pytorch_model.safetensors:  14% 493M/3.44G [00:01<00:11, 250MB/s]


diffusion_pytorch_model.safetensors:  16% 535M/3.44G [00:01<00:10, 280MB/s]


diffusion_pytorch_model.safetensors:  17% 577M/3.44G [00:01<00:09, 299MB/s]


diffusion_pytorch_model.safetensors:  18% 619M/3.44G [00:01<00:08, 315MB/s]


diffusion_pytorch_model.safetensors:  19% 661M/3.44G [00:02<00:08, 318MB/s]


diffusion_pytorch_model.safetensors:  20% 703M/3.44G [00:02<00:08, 324MB/s]


diffusion_pytorch_model.safetensors:  22% 744M/3.44G [00:02<00:08, 331MB/s]


diffusion_pytorch_model.safetensors:  23% 786M/3.44G [00:02<00:08, 326MB/s]


diffusion_pytorch_model.safetensors:  24% 828M/3.44G [00:02<00:07, 339MB/s]


diffusion_pytorch_model.safetensors:  25% 870M/3.44G [00:02<00:07, 336MB/s]


diffusion_pytorch_model.safetensors:  27% 912M/3.44G [00:02<00:07, 339MB/s]


diffusion_pytorch_model.safetensors:  28% 954M/3.44G [00:02<00:07, 346MB/s]


diffusion_pytorch_model.safetensors:  29% 996M/3.44G [00:03<00:07, 345MB/s]


diffusion_pytorch_model.safetensors:  30% 1.04G/3.44G [00:03<00:06, 345MB/s]


diffusion_pytorch_model.safetensors:  31% 1.08G/3.44G [00:03<00:07, 333MB/s]


diffusion_pytorch_model.safetensors:  33% 1.12G/3.44G [00:03<00:06, 335MB/s]


diffusion_pytorch_model.safetensors:  34% 1.16G/3.44G [00:03<00:06, 335MB/s]


diffusion_pytorch_model.safetensors:  35% 1.21G/3.44G [00:03<00:06, 341MB/s]


diffusion_pytorch_model.safetensors:  36% 1.25G/3.44G [00:03<00:06, 340MB/s]


diffusion_pytorch_model.safetensors:  38% 1.29G/3.44G [00:03<00:06, 339MB/s]


diffusion_pytorch_model.safetensors:  39% 1.33G/3.44G [00:04<00:06, 333MB/s]


diffusion_pytorch_model.safetensors:  40% 1.37G/3.44G [00:04<00:06, 336MB/s]


diffusion_pytorch_model.safetensors:  41% 1.42G/3.44G [00:04<00:05, 343MB/s]


diffusion_pytorch_model.safetensors:  42% 1.46G/3.44G [00:04<00:05, 341MB/s]


diffusion_pytorch_model.safetensors:  44% 1.50G/3.44G [00:04<00:05, 336MB/s]


diffusion_pytorch_model.safetensors:  45% 1.54G/3.44G [00:04<00:05, 338MB/s]


diffusion_pytorch_model.safetensors:  46% 1.58G/3.44G [00:04<00:05, 347MB/s]


diffusion_pytorch_model.safetensors:  48% 1.64G/3.44G [00:04<00:04, 372MB/s]


diffusion_pytorch_model.safetensors:  49% 1.68G/3.44G [00:05<00:04, 373MB/s]


diffusion_pytorch_model.safetensors:  50% 1.72G/3.44G [00:05<00:04, 363MB/s]


diffusion_pytorch_model.safetensors:  51% 1.76G/3.44G [00:05<00:05, 305MB/s]


diffusion_pytorch_model.safetensors:  52% 1.80G/3.44G [00:05<00:05, 279MB/s]


diffusion_pytorch_model.safetensors:  53% 1.84G/3.44G [00:05<00:06, 251MB/s]


diffusion_pytorch_model.safetensors:  54% 1.87G/3.44G [00:05<00:07, 221MB/s]


diffusion_pytorch_model.safetensors:  55% 1.90G/3.44G [00:06<00:08, 189MB/s]


diffusion_pytorch_model.safetensors:  56% 1.92G/3.44G [00:06<00:08, 171MB/s]


diffusion_pytorch_model.safetensors:  56% 1.94G/3.44G [00:06<00:09, 160MB/s]


diffusion_pytorch_model.safetensors:  57% 1.96G/3.44G [00:06<00:09, 157MB/s]


diffusion_pytorch_model.safetensors:  58% 1.98G/3.44G [00:06<00:09, 161MB/s]


diffusion_pytorch_model.safetensors:  59% 2.01G/3.44G [00:06<00:07, 192MB/s]


diffusion_pytorch_model.safetensors:  59% 2.04G/3.44G [00:06<00:06, 215MB/s]


diffusion_pytorch_model.safetensors:  61% 2.09G/3.44G [00:07<00:05, 261MB/s]


diffusion_pytorch_model.safetensors:  62% 2.13G/3.44G [00:07<00:04, 281MB/s]


diffusion_pytorch_model.safetensors:  63% 2.16G/3.44G [00:07<00:04, 287MB/s]


diffusion_pytorch_model.safetensors:  64% 2.20G/3.44G [00:07<00:03, 313MB/s]


diffusion_pytorch_model.safetensors:  65% 2.24G/3.44G [00:07<00:03, 316MB/s]


diffusion_pytorch_model.safetensors:  66% 2.29G/3.44G [00:07<00:03, 301MB/s]


diffusion_pytorch_model.safetensors:  67% 2.32G/3.44G [00:07<00:03, 300MB/s]


diffusion_pytorch_model.safetensors:  69% 2.36G/3.44G [00:07<00:03, 329MB/s]


diffusion_pytorch_model.safetensors:  70% 2.40G/3.44G [00:08<00:03, 334MB/s]


diffusion_pytorch_model.safetensors:  71% 2.44G/3.44G [00:08<00:03, 314MB/s]


diffusion_pytorch_model.safetensors:  72% 2.49G/3.44G [00:08<00:03, 310MB/s]


diffusion_pytorch_model.safetensors:  74% 2.53G/3.44G [00:08<00:02, 323MB/s]


diffusion_pytorch_model.safetensors:  75% 2.58G/3.44G [00:08<00:02, 362MB/s]


diffusion_pytorch_model.safetensors:  77% 2.63G/3.44G [00:08<00:02, 388MB/s]


diffusion_pytorch_model.safetensors:  78% 2.68G/3.44G [00:08<00:01, 405MB/s]


diffusion_pytorch_model.safetensors:  80% 2.74G/3.44G [00:08<00:01, 427MB/s]


diffusion_pytorch_model.safetensors:  81% 2.79G/3.44G [00:08<00:01, 445MB/s]


diffusion_pytorch_model.safetensors:  83% 2.85G/3.44G [00:09<00:01, 472MB/s]


diffusion_pytorch_model.safetensors:  85% 2.92G/3.44G [00:09<00:01, 488MB/s]


diffusion_pytorch_model.safetensors:  86% 2.97G/3.44G [00:09<00:00, 497MB/s]


diffusion_pytorch_model.safetensors:  88% 3.03G/3.44G [00:09<00:00, 511MB/s]


diffusion_pytorch_model.safetensors:  90% 3.08G/3.44G [00:09<00:00, 512MB/s]


diffusion_pytorch_model.safetensors:  91% 3.14G/3.44G [00:09<00:00, 481MB/s]


diffusion_pytorch_model.safetensors:  93% 3.19G/3.44G [00:09<00:00, 335MB/s]


diffusion_pytorch_model.safetensors:  94% 3.23G/3.44G [00:11<00:02, 94.1MB/s]


diffusion_pytorch_model.safetensors:  95% 3.28G/3.44G [00:11<00:01, 125MB/s] 


diffusion_pytorch_model.safetensors:  97% 3.33G/3.44G [00:11<00:00, 160MB/s]


diffusion_pytorch_model.safetensors:  98% 3.38G/3.44G [00:11<00:00, 189MB/s]


diffusion_pytorch_model.safetensors: 100% 3.44G/3.44G [00:11<00:00, 290MB/s]
Fetching 8 files: 100% 8/8 [00:13<00:00,  1.69s/it]
Loading pipeline components...: 100% 4/4 [00:01<00:00,  3.20it/s]
[INFO] Loaded Stable Diffusion!
[INFO] Loading Zero123 ...
model_index.json: 100% 562/562 [00:00<00:00, 2.73MB/s]
Fetching 11 files:   0% 0/11 [00:00<?, ?it/s]
clip_camera_projection/config.json: 100% 132/132 [00:00<00:00, 875kB/s]
Fetching 11 files:   9% 1/11 [00:01<00:16,  1.66s/it]
(…)ature_extractor/preprocessor_config.json: 100% 518/518 [00:00<00:00, 4.61MB/s]

scheduler/scheduler_config.json: 100% 502/502 [00:00<00:00, 4.45MB/s]

image_encoder/config.json: 100% 585/585 [00:00<00:00, 4.86MB/s]

unet/config.json: 100% 1.68k/1.68k [00:00<00:00, 15.0MB/s]

vae/config.json: 100% 577/577 [00:00<00:00, 4.08MB/s]

diffusion_pytorch_model.fp16.safetensors: 100% 1.19M/1.19M [00:00<00:00, 30.2MB/s]
Fetching 11 files:  18% 2/11 [00:02<00:09,  1.09s/it]
model.fp16.safetensors:   0% 0.00/608M [00:00<?, ?B/s]

diffusion_pytorch_model.fp16.safetensors:   0% 0.00/1.72G [00:00<?, ?B/s]
model.fp16.safetensors:   3% 21.0M/608M [00:00<00:03, 148MB/s]

diffusion_pytorch_model.fp16.safetensors:   1% 21.0M/1.72G [00:00<00:09, 186MB/s]
model.fp16.safetensors:   9% 52.4M/608M [00:00<00:02, 213MB/s]

diffusion_pytorch_model.fp16.safetensors:   4% 73.4M/1.72G [00:00<00:04, 365MB/s]
model.fp16.safetensors:  16% 94.4M/608M [00:00<00:01, 287MB/s]

diffusion_pytorch_model.fp16.safetensors:   7% 126M/1.72G [00:00<00:03, 426MB/s] 


diffusion_pytorch_model.fp16.safetensors:   0% 0.00/167M [00:00<?, ?B/s]
model.fp16.safetensors:  22% 136M/608M [00:00<00:01, 317MB/s] 

diffusion_pytorch_model.fp16.safetensors:  10% 178M/1.72G [00:00<00:03, 415MB/s]


diffusion_pytorch_model.fp16.safetensors:  13% 21.0M/167M [00:00<00:00, 184MB/s]
model.fp16.safetensors:  29% 178M/608M [00:00<00:01, 326MB/s]

diffusion_pytorch_model.fp16.safetensors:  13% 220M/1.72G [00:00<00:03, 383MB/s]


diffusion_pytorch_model.fp16.safetensors:  38% 62.9M/167M [00:00<00:00, 268MB/s]
model.fp16.safetensors:  36% 220M/608M [00:00<00:01, 319MB/s]

diffusion_pytorch_model.fp16.safetensors:  15% 262M/1.72G [00:00<00:03, 366MB/s]


diffusion_pytorch_model.fp16.safetensors:  56% 94.4M/167M [00:00<00:00, 253MB/s]
model.fp16.safetensors:  43% 262M/608M [00:00<00:01, 307MB/s]


diffusion_pytorch_model.fp16.safetensors:  75% 126M/167M [00:00<00:00, 269MB/s] 

diffusion_pytorch_model.fp16.safetensors:  18% 304M/1.72G [00:00<00:04, 338MB/s]
model.fp16.safetensors:  50% 304M/608M [00:01<00:00, 315MB/s]


diffusion_pytorch_model.fp16.safetensors: 100% 167M/167M [00:00<00:00, 267MB/s]


diffusion_pytorch_model.fp16.safetensors:  20% 346M/1.72G [00:00<00:04, 319MB/s]
model.fp16.safetensors:  57% 346M/608M [00:01<00:00, 332MB/s]

diffusion_pytorch_model.fp16.safetensors:  23% 398M/1.72G [00:01<00:03, 346MB/s]
model.fp16.safetensors:  64% 388M/608M [00:01<00:00, 352MB/s]
model.fp16.safetensors:  71% 430M/608M [00:01<00:00, 351MB/s]

diffusion_pytorch_model.fp16.safetensors:  26% 440M/1.72G [00:01<00:03, 338MB/s]
model.fp16.safetensors:  78% 472M/608M [00:01<00:00, 358MB/s]

diffusion_pytorch_model.fp16.safetensors:  28% 482M/1.72G [00:01<00:03, 342MB/s]
model.fp16.safetensors:  86% 524M/608M [00:01<00:00, 388MB/s]

diffusion_pytorch_model.fp16.safetensors:  30% 524M/1.72G [00:01<00:03, 350MB/s]
model.fp16.safetensors:  93% 566M/608M [00:01<00:00, 327MB/s]

diffusion_pytorch_model.fp16.safetensors:  33% 566M/1.72G [00:01<00:03, 301MB/s]

diffusion_pytorch_model.fp16.safetensors:  35% 598M/1.72G [00:01<00:04, 258MB/s]
model.fp16.safetensors: 100% 608M/608M [00:02<00:00, 296MB/s]
Fetching 11 files:  45% 5/11 [00:04<00:05,  1.17it/s]

diffusion_pytorch_model.fp16.safetensors:  37% 629M/1.72G [00:02<00:04, 239MB/s]

diffusion_pytorch_model.fp16.safetensors:  38% 661M/1.72G [00:02<00:04, 236MB/s]

diffusion_pytorch_model.fp16.safetensors:  41% 713M/1.72G [00:02<00:03, 274MB/s]

diffusion_pytorch_model.fp16.safetensors:  43% 744M/1.72G [00:02<00:03, 267MB/s]

diffusion_pytorch_model.fp16.safetensors:  45% 776M/1.72G [00:02<00:03, 265MB/s]

diffusion_pytorch_model.fp16.safetensors:  47% 807M/1.72G [00:02<00:03, 259MB/s]

diffusion_pytorch_model.fp16.safetensors:  49% 839M/1.72G [00:02<00:03, 253MB/s]

diffusion_pytorch_model.fp16.safetensors:  51% 870M/1.72G [00:02<00:03, 244MB/s]

diffusion_pytorch_model.fp16.safetensors:  52% 902M/1.72G [00:03<00:03, 239MB/s]

diffusion_pytorch_model.fp16.safetensors:  54% 933M/1.72G [00:03<00:03, 229MB/s]

diffusion_pytorch_model.fp16.safetensors:  56% 965M/1.72G [00:03<00:03, 220MB/s]

diffusion_pytorch_model.fp16.safetensors:  58% 996M/1.72G [00:03<00:03, 217MB/s]

diffusion_pytorch_model.fp16.safetensors:  60% 1.03G/1.72G [00:03<00:03, 210MB/s]

diffusion_pytorch_model.fp16.safetensors:  62% 1.06G/1.72G [00:03<00:03, 206MB/s]

diffusion_pytorch_model.fp16.safetensors:  63% 1.08G/1.72G [00:03<00:03, 206MB/s]

diffusion_pytorch_model.fp16.safetensors:  65% 1.11G/1.72G [00:04<00:02, 209MB/s]

diffusion_pytorch_model.fp16.safetensors:  66% 1.14G/1.72G [00:04<00:02, 217MB/s]

diffusion_pytorch_model.fp16.safetensors:  68% 1.17G/1.72G [00:04<00:02, 226MB/s]

diffusion_pytorch_model.fp16.safetensors:  70% 1.21G/1.72G [00:04<00:02, 242MB/s]

diffusion_pytorch_model.fp16.safetensors:  73% 1.25G/1.72G [00:04<00:01, 257MB/s]

diffusion_pytorch_model.fp16.safetensors:  75% 1.29G/1.72G [00:04<00:01, 284MB/s]

diffusion_pytorch_model.fp16.safetensors:  77% 1.32G/1.72G [00:04<00:01, 283MB/s]

diffusion_pytorch_model.fp16.safetensors:  79% 1.35G/1.72G [00:04<00:01, 285MB/s]

diffusion_pytorch_model.fp16.safetensors:  81% 1.38G/1.72G [00:05<00:01, 290MB/s]

diffusion_pytorch_model.fp16.safetensors:  82% 1.42G/1.72G [00:05<00:01, 293MB/s]

diffusion_pytorch_model.fp16.safetensors:  85% 1.46G/1.72G [00:05<00:00, 322MB/s]

diffusion_pytorch_model.fp16.safetensors:  87% 1.50G/1.72G [00:05<00:00, 331MB/s]

diffusion_pytorch_model.fp16.safetensors:  90% 1.54G/1.72G [00:05<00:00, 323MB/s]

diffusion_pytorch_model.fp16.safetensors:  92% 1.58G/1.72G [00:05<00:00, 331MB/s]

diffusion_pytorch_model.fp16.safetensors:  95% 1.63G/1.72G [00:05<00:00, 328MB/s]

diffusion_pytorch_model.fp16.safetensors:  97% 1.67G/1.72G [00:05<00:00, 333MB/s]

diffusion_pytorch_model.fp16.safetensors: 100% 1.72G/1.72G [00:06<00:00, 282MB/s]
Fetching 11 files: 100% 11/11 [00:08<00:00,  1.25it/s]
Loading pipeline components...: 100% 6/6 [00:00<00:00,  8.31it/s]
[INFO] Loaded Stable Diffusion!
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 128, 128, 3])
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 128, 128, 3])
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] 
  | Name        | Type                           | Params
---------------------------------------------------------------
0 | geometry    | ImplicitVolume                 | 12.6 M
1 | material    | NoMaterial                     | 0     
2 | background  | SolidColorBackground           | 0     
3 | renderer    | NeRFVolumeRenderer             | 0     
4 | guidance    | StableDiffusionUnifiedGuidance | 0     
5 | guidance_3d | Zero123UnifiedGuidance         | 0     
---------------------------------------------------------------
12.6 M    Trainable params
0         Non-trainable params
12.6 M    Total params
50.450    Total estimated model params size (MB)
[INFO] Validation results will be saved to outputs/magic123-coarse-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231128-230258/save
[INFO] Using prompt [Hgghly detailed and symmetrical loaf of bread] and negative prompt []
[INFO] Using view-dependent prompts [side]:[Hgghly detailed and symmetrical loaf of bread, side view] [front]:[Hgghly detailed and symmetrical loaf of bread, front view] [back]:[Hgghly detailed and symmetrical loaf of bread, back view] [overhead]:[Hgghly detailed and symmetrical loaf of bread, overhead view]
2023-11-28 23:03:50.812643: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-28 23:03:50.812695: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-28 23:03:50.812719: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-28 23:03:51.853135: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
tokenizer/tokenizer_config.json: 100% 806/806 [00:00<00:00, 4.96MB/s]
tokenizer/vocab.json: 100% 1.06M/1.06M [00:00<00:00, 34.5MB/s]
tokenizer/merges.txt: 100% 525k/525k [00:00<00:00, 70.9MB/s]
tokenizer/special_tokens_map.json: 100% 472/472 [00:00<00:00, 2.99MB/s]
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Epoch 0: |          | 0/? [00:00<?, ?it/s] /usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step_3d', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step_3d': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step_3d', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step_3d': ...})` instead.
Epoch 0: |          | 100/? [01:13<00:00,  1.35it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.56it/s]
Epoch 0: |          | 200/? [02:31<00:00,  1.32it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.61it/s]
Epoch 0: |          | 300/? [03:49<00:00,  1.31it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.63it/s]
Epoch 0: |          | 400/? [05:06<00:00,  1.30it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.70it/s]
Epoch 0: |          | 500/? [06:23<00:00,  1.31it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.80it/s]
Epoch 0: |          | 600/? [07:37<00:00,  1.31it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:02<00:00,  1.94it/s]
Epoch 0: |          | 700/? [08:51<00:00,  1.32it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.11it/s]
Epoch 0: |          | 800/? [10:03<00:00,  1.33it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.28it/s]
Epoch 0: |          | 900/? [11:13<00:00,  1.34it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.44it/s]
Epoch 0: |          | 1000/? [12:23<00:00,  1.35it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.53it/s]
Epoch 0: |          | 1100/? [13:32<00:00,  1.35it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.60it/s]
Epoch 0: |          | 1200/? [14:40<00:00,  1.36it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.68it/s]
Epoch 0: |          | 1300/? [15:49<00:00,  1.37it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.78it/s]
Epoch 0: |          | 1400/? [16:56<00:00,  1.38it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.83it/s]
Epoch 0: |          | 1500/? [18:04<00:00,  1.38it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.89it/s]
Epoch 0: |          | 1600/? [19:12<00:00,  1.39it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.91it/s]
Epoch 0: |          | 1700/? [20:19<00:00,  1.39it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  2.99it/s]
Epoch 0: |          | 1800/? [21:26<00:00,  1.40it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.04it/s]
Epoch 0: |          | 1900/? [22:32<00:00,  1.40it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.08it/s]
Epoch 0: |          | 2000/? [23:39<00:00,  1.41it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.13it/s]
Epoch 0: |          | 2100/? [24:46<00:00,  1.41it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.16it/s]
Epoch 0: |          | 2200/? [25:52<00:00,  1.42it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.12it/s]
Epoch 0: |          | 2300/? [26:58<00:00,  1.42it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.19it/s]
Epoch 0: |          | 2400/? [28:05<00:00,  1.42it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.19it/s]
Epoch 0: |          | 2500/? [29:11<00:00,  1.43it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.24it/s]
Epoch 0: |          | 2600/? [30:17<00:00,  1.43it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.30it/s]
Epoch 0: |          | 2700/? [31:23<00:00,  1.43it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.28it/s]
Epoch 0: |          | 2800/? [32:29<00:00,  1.44it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.30it/s]
Epoch 0: |          | 2900/? [33:35<00:00,  1.44it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.31it/s]
Epoch 0: |          | 3000/? [34:41<00:00,  1.44it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.33it/s]
Epoch 0: |          | 3100/? [35:47<00:00,  1.44it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.35it/s]
Epoch 0: |          | 3200/? [36:53<00:00,  1.45it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.38it/s]
Epoch 0: |          | 3300/? [37:59<00:00,  1.45it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.41it/s]
Epoch 0: |          | 3400/? [39:05<00:00,  1.45it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.41it/s]
Epoch 0: |          | 3500/? [40:11<00:00,  1.45it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.41it/s]
Epoch 0: |          | 3600/? [41:16<00:00,  1.45it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.46it/s]
Epoch 0: |          | 3700/? [42:22<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.46it/s]
Epoch 0: |          | 3800/? [43:28<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.51it/s]
Epoch 0: |          | 3900/? [44:33<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.54it/s]
Epoch 0: |          | 4000/? [45:39<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.55it/s]
Epoch 0: |          | 4100/? [46:44<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.54it/s]
Epoch 0: |          | 4200/? [47:50<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.56it/s]
Epoch 0: |          | 4300/? [48:55<00:00,  1.46it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.56it/s]
Epoch 0: |          | 4400/? [50:00<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.56it/s]
Epoch 0: |          | 4500/? [51:06<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.56it/s]
Epoch 0: |          | 4600/? [52:11<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.59it/s]
Epoch 0: |          | 4700/? [53:17<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.58it/s]
Epoch 0: |          | 4800/? [54:22<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.57it/s]
Epoch 0: |          | 4900/? [55:28<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.58it/s]
Epoch 0: |          | 5000/? [56:33<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.60it/s]
Epoch 0: |          | 5100/? [57:39<00:00,  1.47it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 5200/? [58:44<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 5300/? [59:50<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 5400/? [1:00:55<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 5500/? [1:02:00<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 5600/? [1:03:05<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 5700/? [1:04:11<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.64it/s]
Epoch 0: |          | 5800/? [1:05:16<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 5900/? [1:06:21<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 6000/? [1:07:26<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 6100/? [1:08:32<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.64it/s]
Epoch 0: |          | 6200/? [1:09:37<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 6300/? [1:10:42<00:00,  1.48it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.61it/s]
Epoch 0: |          | 6400/? [1:11:47<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.64it/s]
Epoch 0: |          | 6500/? [1:12:52<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 6600/? [1:13:58<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.64it/s]
Epoch 0: |          | 6700/? [1:15:03<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.61it/s]
Epoch 0: |          | 6800/? [1:16:08<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 6900/? [1:17:14<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 7000/? [1:18:19<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 7100/? [1:19:24<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 7200/? [1:20:30<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 7300/? [1:21:35<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 7400/? [1:22:40<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 7500/? [1:23:46<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.63it/s]
Epoch 0: |          | 7600/? [1:24:51<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 7700/? [1:25:56<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 7800/? [1:27:01<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 7900/? [1:28:07<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.59it/s]
Epoch 0: |          | 8000/? [1:29:12<00:00,  1.49it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 8100/? [1:30:17<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.65it/s]
Epoch 0: |          | 8200/? [1:31:23<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 8300/? [1:32:28<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 8400/? [1:33:33<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.68it/s]
Epoch 0: |          | 8500/? [1:34:38<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.68it/s]
Epoch 0: |          | 8600/? [1:35:44<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.69it/s]
Epoch 0: |          | 8700/? [1:36:49<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.72it/s]
Epoch 0: |          | 8800/? [1:37:54<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.69it/s]
Epoch 0: |          | 8900/? [1:38:59<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.68it/s]
Epoch 0: |          | 9000/? [1:40:05<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.62it/s]
Epoch 0: |          | 9100/? [1:41:10<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.68it/s]
Epoch 0: |          | 9200/? [1:42:15<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.71it/s]
Epoch 0: |          | 9300/? [1:43:20<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.70it/s]
Epoch 0: |          | 9400/? [1:44:25<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.70it/s]
Epoch 0: |          | 9500/? [1:45:31<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.69it/s]
Epoch 0: |          | 9600/? [1:46:36<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.66it/s]
Epoch 0: |          | 9700/? [1:47:41<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.71it/s]
Epoch 0: |          | 9800/? [1:48:47<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.72it/s]
Epoch 0: |          | 9900/? [1:49:52<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.73it/s]
Epoch 0: |          | 10000/? [1:50:57<00:00,  1.50it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:01<00:00,  3.77it/s]
Epoch 0: |          | 10000/? [1:50:58<00:00,  1.50it/s][INFO] `Trainer.fit` stopped: `max_steps=10000` reached.
Epoch 0: |          | 10000/? [1:50:58<00:00,  1.50it/s]
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 128, 128, 3])
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100% 120/120 [00:34<00:00,  3.48it/s]
[INFO] Test results saved to outputs/magic123-coarse-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231128-230258/save

# Export
#!python launch.py --config /content/threestudio/outputs/magic123-coarse-sd/playmobil.png-an_equipped_Playmobil_firefighter_holding_a_hose_in_his_hands@20231112-142137/configs/parsed.yaml --export --gpu 0 resume=/content/threestudio/outputs/magic123-coarse-sd/playmobil.png-an_equipped_Playmobil_firefighter_holding_a_hose_in_his_hands@20231112-142137/ckpts/last.ckpt system.exporter_type=mesh-exporter

# Refine
!python launch.py --config configs/magic123-refine-sd.yaml --train --gpu 0 data.image_path=/content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png system.prompt_processor.prompt="$prompt" system.geometry_convert_from=/content/threestudio/outputs/magic123-coarse-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231128-230258/ckpts/last.ckpt

2023-11-29 00:55:46.471580: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-29 00:55:46.471630: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-29 00:55:46.471658: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-29 00:55:47.580048: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Initializing geometry from a given checkpoint ...
[INFO] Loading Stable Diffusion ...
Loading pipeline components...: 100% 4/4 [00:01<00:00,  3.00it/s]
[INFO] Loaded Stable Diffusion!
[INFO] Loading Zero123 ...
Loading pipeline components...: 100% 6/6 [00:00<00:00,  8.84it/s]
[INFO] Loaded Stable Diffusion!
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 512, 512, 3])
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 512, 512, 3])
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] 
  | Name        | Type                           | Params
---------------------------------------------------------------
0 | geometry    | TetrahedraSDFGrid              | 13.7 M
1 | material    | NoMaterial                     | 0     
2 | background  | SolidColorBackground           | 0     
3 | renderer    | NVDiffRasterizer               | 0     
4 | guidance    | StableDiffusionUnifiedGuidance | 0     
5 | guidance_3d | Zero123UnifiedGuidance         | 0     
---------------------------------------------------------------
13.7 M    Trainable params
0         Non-trainable params
13.7 M    Total params
54.864    Total estimated model params size (MB)
[INFO] Validation results will be saved to outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/save
[INFO] Using prompt [Hgghly detailed and symmetrical loaf of bread] and negative prompt []
[INFO] Using view-dependent prompts [side]:[Hgghly detailed and symmetrical loaf of bread, side view] [front]:[Hgghly detailed and symmetrical loaf of bread, front view] [back]:[Hgghly detailed and symmetrical loaf of bread, back view] [overhead]:[Hgghly detailed and symmetrical loaf of bread, overhead view]
Sanity Checking: |          | 0/? [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Epoch 0: |          | 0/? [00:00<?, ?it/s] /usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/min_step_3d', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/min_step_3d': ...})` instead.
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:212: You called `self.log('train/max_step_3d', ...)` in your `training_step` but the value needs to be floating to be reduced. Converting it to torch.float32. You can silence this warning by converting the value to floating point yourself. If you don't intend to reduce the value (for instance when logging the global step or epoch) then you can use `self.logger.log_metrics({'train/max_step_3d': ...})` instead.
Epoch 0: |          | 100/? [01:03<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.48it/s]
Epoch 0: |          | 200/? [02:07<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.58it/s]
Epoch 0: |          | 300/? [03:11<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.27it/s]
Epoch 0: |          | 400/? [04:15<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.41it/s]
Epoch 0: |          | 500/? [05:18<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.43it/s]
Epoch 0: |          | 600/? [06:22<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.01it/s]
Epoch 0: |          | 700/? [07:26<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.53it/s]
Epoch 0: |          | 800/? [08:30<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.17it/s]
Epoch 0: |          | 900/? [09:34<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.77it/s]
Epoch 0: |          | 1000/? [10:38<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.27it/s]
Epoch 0: |          | 1100/? [11:42<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.94it/s]
Epoch 0: |          | 1200/? [12:46<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.95it/s]
Epoch 0: |          | 1300/? [13:50<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 18.64it/s]
Epoch 0: |          | 1400/? [14:54<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.96it/s]
Epoch 0: |          | 1500/? [15:58<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.62it/s]
Epoch 0: |          | 1600/? [17:02<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.58it/s]
Epoch 0: |          | 1700/? [18:06<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.04it/s]
Epoch 0: |          | 1800/? [19:10<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.23it/s]
Epoch 0: |          | 1900/? [20:14<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.84it/s]
Epoch 0: |          | 2000/? [21:18<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.64it/s]
Epoch 0: |          | 2100/? [22:22<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.05it/s]
Epoch 0: |          | 2200/? [23:26<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.03it/s]
Epoch 0: |          | 2300/? [24:30<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 18.43it/s]
Epoch 0: |          | 2400/? [25:34<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.25it/s]
Epoch 0: |          | 2500/? [26:38<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.73it/s]
Epoch 0: |          | 2600/? [27:41<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.39it/s]
Epoch 0: |          | 2700/? [28:45<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.98it/s]
Epoch 0: |          | 2800/? [29:49<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.03it/s]
Epoch 0: |          | 2900/? [30:53<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.81it/s]
Epoch 0: |          | 3000/? [31:57<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.21it/s]
Epoch 0: |          | 3100/? [33:00<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.93it/s]
Epoch 0: |          | 3200/? [34:04<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 18.93it/s]
Epoch 0: |          | 3300/? [35:08<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.14it/s]
Epoch 0: |          | 3400/? [36:12<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.06it/s]
Epoch 0: |          | 3500/? [37:16<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.29it/s]
Epoch 0: |          | 3600/? [38:20<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.61it/s]
Epoch 0: |          | 3700/? [39:24<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.37it/s]
Epoch 0: |          | 3800/? [40:28<00:00,  1.56it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.71it/s]
Epoch 0: |          | 3900/? [41:31<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.60it/s]
Epoch 0: |          | 4000/? [42:35<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.81it/s]
Epoch 0: |          | 4100/? [43:39<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 18.82it/s]
Epoch 0: |          | 4200/? [44:43<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.95it/s]
Epoch 0: |          | 4300/? [45:47<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.70it/s]
Epoch 0: |          | 4400/? [46:51<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 17.56it/s]
Epoch 0: |          | 4500/? [47:55<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.87it/s]
Epoch 0: |          | 4600/? [48:58<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.31it/s]
Epoch 0: |          | 4700/? [50:02<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.61it/s]
Epoch 0: |          | 4800/? [51:06<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.87it/s]
Epoch 0: |          | 4900/? [52:10<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.29it/s]
Epoch 0: |          | 5000/? [53:13<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.08it/s]
Epoch 0: |          | 5100/? [54:17<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.01it/s]
Epoch 0: |          | 5200/? [55:21<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.79it/s]
Epoch 0: |          | 5300/? [56:25<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.13it/s]
Epoch 0: |          | 5400/? [57:28<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.67it/s]
Epoch 0: |          | 5500/? [58:32<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.68it/s]
Epoch 0: |          | 5600/? [59:36<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.07it/s]
Epoch 0: |          | 5700/? [1:00:40<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.75it/s]
Epoch 0: |          | 5800/? [1:01:44<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.79it/s]
Epoch 0: |          | 5900/? [1:02:47<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.19it/s]
Epoch 0: |          | 6000/? [1:03:51<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.96it/s]
Epoch 0: |          | 6100/? [1:04:55<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.94it/s]
Epoch 0: |          | 6200/? [1:05:59<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.71it/s]
Epoch 0: |          | 6300/? [1:07:02<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.08it/s]
Epoch 0: |          | 6400/? [1:08:06<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.04it/s]
Epoch 0: |          | 6500/? [1:09:10<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.53it/s]
Epoch 0: |          | 6600/? [1:10:14<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.53it/s]
Epoch 0: |          | 6700/? [1:11:17<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 18.10it/s]
Epoch 0: |          | 6800/? [1:12:21<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.78it/s]
Epoch 0: |          | 6900/? [1:13:25<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.83it/s]
Epoch 0: |          | 7000/? [1:14:29<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.42it/s]
Epoch 0: |          | 7100/? [1:15:32<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.73it/s]
Epoch 0: |          | 7200/? [1:16:36<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.90it/s]
Epoch 0: |          | 7300/? [1:17:40<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.45it/s]
Epoch 0: |          | 7400/? [1:18:43<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.50it/s]
Epoch 0: |          | 7500/? [1:19:47<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.57it/s]
Epoch 0: |          | 7600/? [1:20:51<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.79it/s]
Epoch 0: |          | 7700/? [1:21:55<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.39it/s]
Epoch 0: |          | 7800/? [1:22:59<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.31it/s]
Epoch 0: |          | 7900/? [1:24:02<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.59it/s]
Epoch 0: |          | 8000/? [1:25:06<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.19it/s]
Epoch 0: |          | 8100/? [1:26:10<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.44it/s]
Epoch 0: |          | 8200/? [1:27:14<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.86it/s]
Epoch 0: |          | 8300/? [1:28:17<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.94it/s]
Epoch 0: |          | 8400/? [1:29:21<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.73it/s]
Epoch 0: |          | 8500/? [1:30:25<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.26it/s]
Epoch 0: |          | 8600/? [1:31:29<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.28it/s]
Epoch 0: |          | 8700/? [1:32:32<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.06it/s]
Epoch 0: |          | 8800/? [1:33:36<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.85it/s]
Epoch 0: |          | 8900/? [1:34:40<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.97it/s]
Epoch 0: |          | 9000/? [1:35:44<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.34it/s]
Epoch 0: |          | 9100/? [1:36:47<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.37it/s]
Epoch 0: |          | 9200/? [1:37:51<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.39it/s]
Epoch 0: |          | 9300/? [1:38:55<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.52it/s]
Epoch 0: |          | 9400/? [1:39:59<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.29it/s]
Epoch 0: |          | 9500/? [1:41:02<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.47it/s]
Epoch 0: |          | 9600/? [1:42:06<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.57it/s]
Epoch 0: |          | 9700/? [1:43:10<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.81it/s]
Epoch 0: |          | 9800/? [1:44:14<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 19.07it/s]
Epoch 0: |          | 9900/? [1:45:17<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 20.82it/s]
Epoch 0: |          | 10000/? [1:46:21<00:00,  1.57it/s]
Validation: |          | 0/? [00:00<?, ?it/s]
Validation:   0% 0/4 [00:00<?, ?it/s]        
Validation DataLoader 0:   0% 0/4 [00:00<?, ?it/s]
Validation DataLoader 0: 100% 4/4 [00:00<00:00, 21.44it/s]
Epoch 0: |          | 10000/? [1:46:22<00:00,  1.57it/s][INFO] `Trainer.fit` stopped: `max_steps=10000` reached.
Epoch 0: |          | 10000/? [1:46:22<00:00,  1.57it/s]
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 512, 512, 3])
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100% 120/120 [00:08<00:00, 13.59it/s]
[INFO] Test results saved to outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/save

# Export Refine
!python launch.py --config /content/threestudio/outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/configs/parsed.yaml --export --gpu 0 resume=/content/threestudio/outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/ckpts/last.ckpt system.exporter_type=mesh-exporter

2023-11-29 02:50:00.938975: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-29 02:50:00.939028: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-29 02:50:00.939066: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-29 02:50:02.014068: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_5m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_5m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_11m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_11m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_224 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_384 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
/usr/local/lib/python3.10/dist-packages/controlnet_aux/segment_anything/modeling/tiny_vit_sam.py:654: UserWarning: Overwriting tiny_vit_21m_512 in registry with controlnet_aux.segment_anything.modeling.tiny_vit_sam.tiny_vit_21m_512. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  return register_model(fn_wrapper)
Seed set to 0
[INFO] Loading Stable Diffusion ...
Loading pipeline components...: 100% 4/4 [00:01<00:00,  3.41it/s]
[INFO] Loaded Stable Diffusion!
[INFO] Loading Zero123 ...
Loading pipeline components...: 100% 6/6 [00:00<00:00,  9.37it/s]
[INFO] Loaded Stable Diffusion!
[INFO] GPU available: True (cuda), used: True
[INFO] TPU available: False, using: 0 TPU cores
[INFO] IPU available: False, using: 0 IPUs
[INFO] HPU available: False, using: 0 HPUs
[INFO] single image dataset: load image /content/drive/MyDrive/threestudio/magic123-coarse-sd/breadNoBG.png torch.Size([1, 512, 512, 3])
[INFO] Restoring states from the checkpoint path at /content/threestudio/outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/ckpts/last.ckpt
[INFO] LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[INFO] Loaded model weights from the checkpoint at /content/threestudio/outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/ckpts/last.ckpt
/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'predict_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Predicting DataLoader 0:   0% 0/120 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/pytorch_lightning/loops/prediction_loop.py:252: predict returned None if it was on purpose, ignore this warning...
Predicting DataLoader 0: 100% 120/120 [00:01<00:00, 98.45it/s][INFO] Using xatlas to perform UV unwrapping, may take a while ...
[INFO] Exporting textures ...
[INFO] Perform UV padding on texture maps to avoid seams, may take a while ...
Predicting DataLoader 0: 100% 120/120 [00:36<00:00,  3.27it/s]
[INFO] Export assets saved to outputs/magic123-refine-sd/breadNoBG.png-Hgghly_detailed_and_symmetrical_loaf_of_bread@20231129-005549/save

!cp -r /content/threestudio/outputs/magic123-coarse-sd/ /content/drive/MyDrive/threestudio/
!cp -r /content/threestudio/outputs/magic123-refine-sd/ /content/drive/MyDrive/threestudio/

Zero-1-to-3 (requires image with no background and high ram)
↳ 4 cells hidden
Analyze mesh
↳ 1 cell hidden
Colab paid products - Cancel contracts here
